{% extends "base.html" %}
{% block content %}
<h2>üìã –û–±—Ä–∞—â–µ–Ω–∏—è</h2>

<button class="btn btn-primary mb-3" data-bs-toggle="modal" data-bs-target="#addRequestModal">
    ‚ûï –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞—â–µ–Ω–∏–µ
</button>

<!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è -->
{% if requests_pagination.pages > 1 %}
<nav aria-label="–ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º">
    <ul class="pagination justify-content-center">
        <li class="page-item {% if not requests_pagination.has_prev %}disabled{% endif %}">
            <a class="page-link" href="{{ url_for('main.requests', page=requests_pagination.prev_num) }}">
                ‚Üê –ù–∞–∑–∞–¥
            </a>
        </li>

        {% for page_num in requests_pagination.iter_pages() %}
            {% if page_num %}
                <li class="page-item {% if page_num == requests_pagination.page %}active{% endif %}">
                    <a class="page-link" href="{{ url_for('main.requests', page=page_num) }}">
                        {{ page_num }}
                    </a>
                </li>
            {% else %}
                <li class="page-item disabled"><span class="page-link">...</span></li>
            {% endif %}
        {% endfor %}

        <li class="page-item {% if not requests_pagination.has_next %}disabled{% endif %}">
            <a class="page-link" href="{{ url_for('main.requests', page=requests_pagination.next_num) }}">
                –í–ø–µ—Ä–µ–¥ ‚Üí
            </a>
        </li>
    </ul>
</nav>
{% endif %}

<div class="alert alert-info">
    –°—Ç—Ä–∞–Ω–∏—Ü–∞ {{ requests_pagination.page }} –∏–∑ {{ requests_pagination.pages }}
    (–ø–æ–∫–∞–∑–∞–Ω–æ {{ requests_pagination.items|length }} –∏–∑ {{ requests_pagination.total }} –æ–±—Ä–∞—â–µ–Ω–∏–π)
</div>

<table class="table table-striped">
    <thead>
    <tr>
        <th>ID</th>
        <th>–ê–≤—Ç–æ–º–æ–±–∏–ª—å</th>
        <th>–î–∞—Ç–∞</th>
        <th>–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º</th>
    </tr>
    </thead>
    <tbody>
    {% for req in requests_pagination.items %}
        <tr>
            <td>{{ req.id }}</td>
            <td>{{ req.car.number }} ({{ req.car.brand }})</td>
            <td>{{ req.formatted_request_date }}</td>
            <td>{{ req.issues }}</td>
        </tr>
    {% endfor %}
    </tbody>
</table>

<!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è —Å–Ω–∏–∑—É -->
{% if requests_pagination.pages > 1 %}
<nav aria-label="–ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º">
    <ul class="pagination justify-content-center">
        <li class="page-item {% if not requests_pagination.has_prev %}disabled{% endif %}">
            <a class="page-link" href="{{ url_for('main.requests', page=requests_pagination.prev_num) }}">
                ‚Üê –ù–∞–∑–∞–¥
            </a>
        </li>

        {% for page_num in requests_pagination.iter_pages() %}
            {% if page_num %}
                <li class="page-item {% if page_num == requests_pagination.page %}active{% endif %}">
                    <a class="page-link" href="{{ url_for('main.requests', page=page_num) }}">
                        {{ page_num }}
                    </a>
                </li>
            {% else %}
                <li class="page-item disabled"><span class="page-link">...</span></li>
            {% endif %}
        {% endfor %}

        <li class="page-item {% if not requests_pagination.has_next %}disabled{% endif %}">
            <a class="page-link" href="{{ url_for('main.requests', page=requests_pagination.next_num) }}">
                –í–ø–µ—Ä–µ–¥ ‚Üí
            </a>
        </li>
    </ul>
</nav>
{% endif %}

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –æ–±—Ä–∞—â–µ–Ω–∏—è (–æ—Å—Ç–∞–µ—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π) -->
<div class="modal fade" id="addRequestModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
        <form method="post" class="modal-content">
            <div class="modal-header"><h5 class="modal-title">–ù–æ–≤–æ–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ</h5></div>
            <div class="modal-body">
                <select class="form-control mb-2" name="car_id" required>
                    {% for car in cars %}
                        <option value="{{ car.id }}">{{ car.number }} ({{ car.brand }})</option>
                    {% endfor %}
                </select>
                <textarea class="form-control mb-2" name="issues" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º" required></textarea>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" data-bs-dismiss="modal">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn btn-primary" type="submit">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </div>
        </form>
    </div>
</div>
{% endblock %}